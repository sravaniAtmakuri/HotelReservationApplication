package org.apache.jsp;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import java.time.temporal.ChronoUnit;
import java.util.concurrent.TimeUnit;
import java.time.LocalDate;
import java.util.Locale;
import java.time.format.DateTimeFormatter;
import java.util.Enumeration;
import javax.servlet.http.HttpSession;
import java.util.List;
import bean.RoomBean;
import Service.Service;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import java.util.ArrayList;

public final class CardDetailsPage_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final JspFactory _jspxFactory = JspFactory.getDefaultFactory();

  private static java.util.List<String> _jspx_dependants;

  private org.glassfish.jsp.api.ResourceInjector _jspx_resourceInjector;

  public java.util.List<String> getDependants() {
    return _jspx_dependants;
  }

  public void _jspService(HttpServletRequest request, HttpServletResponse response)
        throws java.io.IOException, ServletException {

    PageContext pageContext = null;
    HttpSession session = null;
    ServletContext application = null;
    ServletConfig config = null;
    JspWriter out = null;
    Object page = this;
    JspWriter _jspx_out = null;
    PageContext _jspx_page_context = null;

    try {
      response.setContentType("text/html");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;
      _jspx_resourceInjector = (org.glassfish.jsp.api.ResourceInjector) application.getAttribute("com.sun.appserv.jsp.resource.injector");

      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("<!DOCTYPE html>\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
 RoomBean roombean=(RoomBean) session.getAttribute("roomBean"); 
      out.write('\n');
String str=request.getRequestURL()+"?";
Enumeration<String> paramNames = request.getParameterNames();

while (paramNames.hasMoreElements())
{
    String paramName = paramNames.nextElement();
    System.out.println(""+paramName);
    String[] paramValues = request.getParameterValues(paramName);
  //   System.out.println(""+paramValues.length);
    for (int i = 0; i < paramValues.length; i++) 
    {
        String paramValue = paramValues[i];
         System.out.println(""+paramValue);
        str=str + paramName + "=" + paramValue;
    }
    str=str+"&";
}
System.out.println(str.substring(0,str.length()-1)+"\t"); 
 String hotelID=request.getParameter("HotelID");
 String roomNo=request.getParameter("messageroomNo");
 
 System.out.println("roomNo is: "+roomNo+" hotelID is : "+hotelID);
 String checkindateString = (String)session.getAttribute("date");
  String checkoutdateString = (String)session.getAttribute("date1");
DateTimeFormatter formatter = DateTimeFormatter.ofPattern("yyyy-MM-dd", Locale.ENGLISH);
LocalDate checkindate = LocalDate.parse(checkindateString,formatter);
LocalDate checkoutdate=LocalDate.parse(checkoutdateString, formatter);
System.out.println("checkindate is :"+checkindate+"check out date is: "+checkoutdate);
long numberOfdays= ChronoUnit.DAYS.between(checkindate, checkoutdate);
System.out.println("number of nights is: "+numberOfdays );
session.setAttribute("NoOfDays", numberOfdays);

String priceString = request.getParameter("Price");
String roomdescription=request.getParameter("description");
String desc=""+roomdescription;
session.setAttribute("description", roomdescription);
System.out.println("Room description in carddetails jsp is: "+roomdescription);
System.out.println("Room description in carddetails jsp is: "+desc);
double subtotal = Double.parseDouble(priceString)*numberOfdays;
double tax = subtotal *0.10;
double total = subtotal+tax;
session.setAttribute("totalamount", total);
session.setAttribute("noOfDays", numberOfdays);


      out.write("\n");
      out.write("\n");
      out.write("<html lang=\"en\">\n");
      out.write("\n");
      out.write("<head>\n");
      out.write("\t<meta charset=\"utf-8\">\n");
      out.write("\t<title> Hulton Hotel Reservation</title>\n");
      out.write("\t<meta name=\"description\" content=\"Smart Health App\">\n");
      out.write("\n");
      out.write("\n");
      out.write("<link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\">\n");
      out.write("\n");
      out.write("<!-- Optional theme -->\n");
      out.write("<link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css\">\n");
      out.write("<Style>\t\n");
      out.write(".modal-dialog{\n");
      out.write("   position: absolute;\n");
      out.write("   left: 50%;\n");
      out.write("   /* now you must set a margin left under zero - value is a half width your window */\n");
      out.write("   margin-left: -550px;\n");
      out.write("   /* this same situation is with height - example */\n");
      out.write("   height: 450px;\n");
      out.write("   top: 50%;\n");
      out.write("   width: 40%;\n");
      out.write("   margin-top: -100px;\n");
      out.write("} \n");
      out.write(".modal-dialog1{\n");
      out.write("   position: absolute;\n");
      out.write("   left: 70%;\n");
      out.write("   /* now you must set a margin left under zero - value is a half width your window */\n");
      out.write("   margin-left: -150px;\n");
      out.write("   alignment-adjust:auto;\n");
      out.write("   /* this same situation is with height - example */\n");
      out.write("   height: 600px;\n");
      out.write("   top: 50%;\n");
      out.write("   width: 35%;\n");
      out.write("   margin-top: -100px;\n");
      out.write("} \n");
      out.write("</style>\n");
      out.write("</head>\n");
      out.write("\n");
      out.write("<script>\n");
      out.write("     function myFunction() {\n");
      out.write("          var securitycode = document.getElementById('securityCode').value;\n");
      out.write("          if (securitycode.length>3) {\n");
      out.write("           alert(\"Error: cannot be more than 3 digits!\");\n");
      out.write("           form.securityCode.focus();\n");
      out.write("           return false;\n");
      out.write("        }else {\n");
      out.write("           // alert(\"Login Successfull!!!\");\n");
      out.write("            document.getElementById(\"CardDetailsPage.jsp\").submit();\n");
      out.write("            return true;\n");
      out.write("        }\n");
      out.write("     }\n");
      out.write("   \n");
      out.write("</script>\t\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\t\n");
      out.write("<body>\n");
      out.write("\n");
      out.write("  \t\t<nav class= \"navbar navbar-inverse navbar-fixed-top\" id=\"my-navbar\">\n");
      out.write("                    <div class=\"container\">\n");
      out.write("\t<div class=\"navbar-header\">\n");
      out.write("\t\t\n");
      out.write("\t</div><!--navbar header-->\n");
      out.write("\t\n");
      out.write("\t<div class=\"collapse navbar-collapse\" id=\"navbar-collapse\">\n");
      out.write("\t<ul class=\"nav navbar-nav\">\n");
      out.write("\t <h4 class=\"navbar-text\">Logged in as &nbsp;");
      out.print(session.getAttribute("userName") );
      out.write("</h4> \n");
      out.write("        </ul>\n");
      out.write("             <ul class=\"nav navbar-nav navbar-right\">\n");
      out.write("         <li><a href=\"loginPage.jsp\">LOGOUT</a>\n");
      out.write("             </ul>\n");
      out.write("  \t\t\t\n");
      out.write("  \t\t</nav> \n");
      out.write("\n");
      out.write("  \t\t\n");
      out.write("\n");
      out.write("  \t\t<div class=\"jumbotron\">\n");
      out.write("\t\t\t<div class=\"container text-center\" style=\"max-height: 100px\">\n");
      out.write("\t\t\t\t<h1>HULTON HOTEL </h1>\n");
      out.write("\t\t\t</div>\n");
      out.write("                </div>\n");
      out.write("\n");
      out.write("\n");
      out.write(" <div class=\"modal-dialog\">\n");
      out.write("    <div class=\"modal-content\">\n");
      out.write("        <div class=\"modal-header\">\n");
      out.write("            <h1 class=\"text-center\">Card Information</h1>\n");
      out.write("        </div>\n");
      out.write("        <form class=\"form-horizontal\" id=\"patientReg\" method=\"post\" action=\"CardDetailsPageServlet\" onsubmit=\"return myfunction()\">\n");
      out.write("       <!--  <form  action=\"PatientRegistration\" method=\"post\">  -->\n");
      out.write("             <div class=\"modal-body\">\n");
      out.write("                 \n");
      out.write("                  <div class=\"form-group\">\n");
      out.write("                <input type=\"hidden\" name=\"roomNo\" id=\"roomNo\" class=\"form-control\" value=");
      out.print(roomNo );
      out.write("  />\n");
      out.write("                </div>\n");
      out.write("                 <div class=\"form-group\">\n");
      out.write("                <input type=\"hidden\" name=\"hotelID\" id=\"hotelID\" class=\"form-control\" value=");
      out.print(hotelID );
      out.write("  />\n");
      out.write("                </div>\n");
      out.write("                 <div class=\"form-group\">\n");
      out.write("                <input type=\"hidden\" name=\"roomdescription\" id=\"roomdescription\" value=");
      out.print(desc);
      out.write("  />\n");
      out.write("                </div>\n");
      out.write("\n");
      out.write("             \n");
      out.write("             <div class=\"form-group\">\n");
      out.write("               Card Number:  <input type=\"text\" name=\"cardnumber\" id=\"cardnumber\" required=\"required\" class=\"form-control\" maxlength=\"16\" pattern=\"[0-9]{16}\"  placeholder=\"Enter your Card Number\"/>\n");
      out.write("                </div>\n");
      out.write("\n");
      out.write("             <div class=\"form-group\">\n");
      out.write("               Card Type: <select class=\"form-control\" id=\"cardType\" name=\"cardType\">\n");
      out.write("              <option>Visa</option>\n");
      out.write("              <option>Master</option>\n");
      out.write("              <option>Discover</option>\n");
      out.write("              <option>Amex</option>\n");
      out.write("              <option>Diners Club</option>\n");
      out.write("              <option>Australian BankCard</option>\n");
      out.write("              <option>Sears Canada</option>\n");
      out.write("              <option>Carte Blanche</option>\n");
      out.write("              </select>\n");
      out.write("             </div>\n");
      out.write("              <div class=\"form-group\">\n");
      out.write("               Name On Card: <input type=\"text\"  name=\"nameOnCard\" id=\"nameOnCard\"  required=\"required\"  class=\"form-control\"  placeholder=\"Enter your name on Card\"/>\n");
      out.write("                </div>\n");
      out.write("             \n");
      out.write("             <div class=\"form-group\">\n");
      out.write("             Billing Address:<input type=\"text\" name=\"billingAddress\" id=\"billingAddress\" required = \"required\"  class=\"form-control\"   placeholder=\"Enter your billing address\"/>                    \n");
      out.write("                </div>\n");
      out.write("             \n");
      out.write("             \n");
      out.write("             <div class=\"form-group\">\n");
      out.write("                Security Code:<input type=\"password\"  name=\"securityCode\" id=\"securityCode\" required=\"required\" class=\"form-control\" maxlength=\"3\" pattern=\"[0-9]{3}\"  placeholder=\"Enter the security code on card\"/>\n");
      out.write("                </div>\n");
      out.write("\n");
      out.write("            <div class=\"form-inline\">\n");
      out.write("              Expiry Date: <select class=\"form-control\" id=\"Month\" name=\"Month\">\n");
      out.write("              <option>01</option>\n");
      out.write("              <option>02</option>\n");
      out.write("              <option>03</option>\n");
      out.write("              <option>04</option>\n");
      out.write("              <option>05</option>\n");
      out.write("              <option>06</option>\n");
      out.write("              <option>07</option>\n");
      out.write("              <option>08</option>\n");
      out.write("              <option>09</option>\n");
      out.write("              <option>10</option>\n");
      out.write("              <option>11</option>\n");
      out.write("              <option>12</option>\n");
      out.write("              </select> \n");
      out.write("              <select class=\"form-control\" id=\"Year\" name=\"Year\">\n");
      out.write("             <option>2017</option>\n");
      out.write("              <option>2018</option>\n");
      out.write("              <option>2019</option>\n");
      out.write("              <option>2020</option>\n");
      out.write("              <option>2021</option>\n");
      out.write("              <option>2022</option>\n");
      out.write("              <option>2023</option>\n");
      out.write("              <option>2024</option>\n");
      out.write("              <option>2025</option>\n");
      out.write("              <option>2026</option>\n");
      out.write("              <option>2027</option>\n");
      out.write("              <option>2028</option>\n");
      out.write("              <option>2029</option>\n");
      out.write("              <option>2030</option>\n");
      out.write("              <option>2031</option>\n");
      out.write("              <option>2032</option>\n");
      out.write("              <option>2033</option>\n");
      out.write("              <option>2034</option>\n");
      out.write("              <option>2035</option>\n");
      out.write("              <option>2036</option>\n");
      out.write("              </select> \n");
      out.write("            </div>  \n");
      out.write("                 \n");
      out.write("              <br>\n");
      out.write("               <div class=\"form-group\">\n");
      out.write("                                              \n");
      out.write("                 <input type=\"submit\" class=\"btn btn-block btn-lg btn-primary\" value=\"Confirm and Book\"/>\n");
      out.write("                \n");
      out.write("             </div>\n");
      out.write("         \n");
      out.write("             \n");
      out.write("            \n");
      out.write("         </div>\n");
      out.write("                       \n");
      out.write("                             </form>\n");
      out.write("                  \n");
      out.write("\n");
      out.write("    </div>\n");
      out.write(" </div>\n");
      out.write("<div class=\"modal-dialog1\">\n");
      out.write("                        <div class=\"modal-content\">\n");
      out.write("                            <div class=\"modal-header\">\n");
      out.write("                                <h1 class=\"text-center\">Billing Information</h1>\n");
      out.write("                            </div>\n");
      out.write("                            <form class=\"form-horizontal\" id=\"billingInfo\" method=\"post\" action=\"\" onsubmit=\"\">\n");
      out.write("                                <!--  <form  action=\"PatientRegistration\" method=\"post\">  -->\n");
      out.write("                                <div class=\"modal-body modal-lg\">\n");
      out.write("                                    <div class=\"form-inline\" >\n");
      out.write("\n");
      out.write("\n");
      out.write("                                        <table  style=\"width:50%\" cellspacing=\"0\" cellpadding=\"0\">\n");
      out.write("                                            <tr>\n");
      out.write("                                             <font size=\"5\" > Reservation Details</font>\n");
      out.write("                                            </tr>\n");
      out.write("                                            <tr class=\"blank_row\"><td>&nbsp;</td></tr>\n");
      out.write("\n");
      out.write("                                            <tr>\n");
      out.write("                                                <td  width=\"30%\" align=\"left\"><b>Room Type</b></td>\n");
      out.write("                                                <td align=\"left\">");
      out.print(request.getParameter("roomtype"));
      out.write("&nbsp;(");
      out.print(roomdescription );
      out.write(")</td> \n");
      out.write("                                            </tr>\n");
      out.write("                                            <tr class=\"blank_row\"><td>&nbsp;</td></tr>\n");
      out.write("                                            <tr>\n");
      out.write("                                                <td  width=\"40%\" align=\"left\"><b>Arrival</b></td>\n");
      out.write("                                                <td align=\"center\">");
      out.print(session.getAttribute("date"));
      out.write("</td>\n");
      out.write("\n");
      out.write("                                            </tr>\n");
      out.write("                                            <tr class=\"blank_row\"><td>&nbsp;</td></tr>\n");
      out.write("                                            <tr>\n");
      out.write("                                                <td  width=\"40%\" align=\"left\"><b>Departure</b></td>\n");
      out.write("                                                <td align=\"center\">");
      out.print(session.getAttribute("date1"));
      out.write("</td> \n");
      out.write("                                            </tr>\n");
      out.write("                                            <tr class=\"blank_row\"><td>&nbsp;</td></tr>\n");
      out.write("                                            <tr>\n");
      out.write("                                                <td  width=\"40%\" align=\"left\"><b>Number of days</b></td>\n");
      out.write("                                                <td align=\"center\">");
      out.print(numberOfdays );
      out.write("</td> \n");
      out.write("                                            </tr>\n");
      out.write("                                            <tr class=\"blank_row\"><td>&nbsp;</td></tr>\n");
      out.write("                                         \n");
      out.write("                                           <tr>\n");
      out.write("                                                <td  width=\"40%\" align=\"left\"><b>Best Available Rate</b></td>\n");
      out.write("                                                <td align=\"center\">");
      out.print(priceString );
      out.write("&nbsp; USD</td> \n");
      out.write("                                            </tr>\n");
      out.write("                                               <tr class=\"blank_row\"><td>&nbsp;</td></tr>\n");
      out.write("                                                  <tr class=\"blank_row\"><td>&nbsp;</td></tr>\n");
      out.write("                                             <tr>\n");
      out.write("                                                <td  width=\"40%\" align=\"left\"><b>Subtotal</b></td>\n");
      out.write("                                                <td align=\"center\">");
      out.print(subtotal );
      out.write(" &nbsp; USD</td> \n");
      out.write("                                            </tr>\n");
      out.write("                                             <tr>\n");
      out.write("                                                <td  width=\"40%\" align=\"left\"><b>Taxes & Fees </b></td>\n");
      out.write("                                                <td align=\"center\">");
      out.print(tax );
      out.write("&nbsp; USD</td> \n");
      out.write("                                            </tr>\n");
      out.write("                                             <tr>\n");
      out.write("                                                <td  width=\"40%\" align=\"left\"><b> Estimated Total Cost </b></td>\n");
      out.write("                                                <td align=\"center\"><font color=\"green\" size=\"4\"><b>");
      out.print( total );
      out.write("&nbsp; USD</b></td> \n");
      out.write("                                            </tr>\n");
      out.write("                                        </table>\n");
      out.write("\n");
      out.write("                                    </div>           \n");
      out.write("              <br>\n");
      out.write("             \n");
      out.write("                      \n");
      out.write("                                \n");
      out.write("    </div>\n");
      out.write(" </div>\n");
      out.write("\n");
      out.write("  \t\t\n");
      out.write("    <script src=\"https://code.jquery.com/jquery-3.1.1.js\"> </script>\n");
      out.write("  \n");
      out.write("  <script src=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\"> </script>\n");
      out.write("</body>\t\n");
      out.write("</html> ");
    } catch (Throwable t) {
      if (!(t instanceof SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          out.clearBuffer();
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
